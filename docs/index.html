<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Leaflet Map</title>

    <!-- import styling -->
    <link rel="stylesheet" href="css/leaflet.css"/>

    <!-- custom styling -->
    <style type="text/css">
      body{
        margin: 0;
        padding: 0;
      }
      #map {
        width: 100vw;
        height: 100vh;
      }
    </style>
  </head>
  <body>
    <!-- element that contains map -->
    <div id="map"></div>

    <!-- import packages -->
    <script src="js/leaflet.js"></script>

    <!-- load data -->
    <script src="data/axesofreconstruction_crs84.js"></script>
    <script src="data/featuretraces_crs84.js"></script>
    <script src="data/profileextents_crs84.js"></script>
    <script src="data/mapextents_crs84.js"></script>

    <!-- custom code for the leaflet map -->
    <script>
        // Map Object
        const map = L.map('map', {
            center: [36.85324009154614, 10.323104630306315],
            zoom: 18,
            zoomControl: true,
            maxZoom: 28,
            minZoom: 18
            });
        
        // Basemap
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors' }).addTo(map);

        // Styles
        var highlightStyle = {
          weight: 5,
          color: '#666',
          fillOpacity: 0.7
        }
        var defaultStyle = {
          color: 'blue'
        }

        // Interaction
        function highlightFeature(e) {
          var layer = e.target;

          layer.setStyle(highlightStyle);

          // I'm not sure if this is necessary, but both GPT and
          // Stack Overflow (https://gis.stackexchange.com/q/227377)
          // suggested it
          if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
            layer.bringToFront();
          }
        }

        function onEachFeature(feature, layer, geoJsonLayer) {
          // Note the distinction between `layer` and `geoJsonLayer` - only the
          // former has the resetStyle() method
          layer.on({
            mouseover: highlightFeature,
            mouseout: function(e) {
              geoJsonLayer.resetStyle(e.target);
            }
          });
        }

        // Add Data to map
        function addGeoJsonLayer(geoJsonData, map) {
          // Create a container layer to add interactivity to
          var geoJsonLayer = L.geoJSON(geoJsonData, {
            style: function () {
              return { color: 'blue' }; // Default style
            }
          }).addTo(map);

          // Interactivity has to be added with explicit reference to container
          geoJsonLayer.eachLayer(function(layer) {
            onEachFeature(layer.feature, layer, geoJsonLayer);
          });

          return geoJsonLayer;
        }

        // When you add a new GeoJSON layer, get the layer instance
        var myGeoJsonLayer = addGeoJsonLayer(featureTraces, map);
    </script>
    </body>
</html>
